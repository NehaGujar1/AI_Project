<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="drought.css">
</head>
<body id="bg" style="font-family: 'Comic Sans MS';">
    <div class="add_space"></div>
    <div id="divi"><h1><p id="main_text">Enter rainfall in ml</p></h1></div>
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="wid" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="len" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="elon" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="slan" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="slat" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="fat" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="inj" />
    <input style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-size: 2vh; text-align: center;" type="text" id="mag" />
    <div class="add_space2"></div>
    <button style="justify-self: center;margin: auto; display: block; height: 4vh; width: 10vw; background-color: #ffffffaf; font-weight: bolder; font-size: 2vh;" type="button" id="makeprediction">PREDICT</button>
    <p id="tord"></p>
    <!-- <script>
    function takeInput() {
        let x = document.getElementById("rain_val").value;
        console.log(x)
    }
    </script> -->
    <py-env>
        - numpy
        - pandas
        - sklearn
        - seaborn
        - matplotlib.pyplot
    </py-env>
    <py-script>
        # -*- coding: utf-8 -*-
"""Tornado.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1b8xHZ9xk-kMr6g8BHpP9BdzNRXJxa_Ax
"""
from js import (
            document,
            Blob,
            URL
        )
from pyodide import create_proxy
def inputval():
    wid = document.getElementById("wid")
    len = document.getElementById("len")
    elon = document.getElementById("elon")
    slon = document.getElementById("slon")
    slat = document.getElementById("slat")
    fat = document.getElementById("fat")
    inj = document.getElementById("inj")
    mag = document.getElementById("mag")
    inputvals = [wid , len , elon , elat , slon , slat , fat , inj , mag]
    tornadopred(inputvals)
e = document.getElementById("makeprediction")
e.addEventListener("click",create_proxy(inputval))
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
# %matplotlib inline
def tornadopred(inputvals) :
    data1 = pd.read_csv('us_tornado_dataset_1950_2021.csv')
    data1 = data1.drop(columns=["yr","mo","dy","date"])
    x3 = data1.drop(columns=["st"])
    y3 = data1["st"]
    data1.head()
    #linear regression

    #sns.heatmap(data1.corr())

    # plt.scatter(x3,y3,color='blue',marker='*')
    from sklearn import linear_model
    data1le = data1
    data1le.st = le.fit_transform(data1le.st)
    X = data1le[["wid","len","elon","elat","slon","slat","fat","inj","mag"]]
    Y = data1le["st"]
    from sklearn.model_selection import train_test_split
    x_train, x_test, y_train, y_test = train_test_split(X,Y,test_size=0.2)
    reg = linear_model.LinearRegression()
    reg.fit(x_train,y_train)
    reg.coef_
    reg.intercept_
    # reg.predict([[42,43,10]])
    reg.score(x_test,y_test)


    joblib.dump(data1,'model_joblib')
    mj = joblib.load('model_joblib')
    # mj.predict([[42,43,10]])

    from sklearn.linear_model import LogisticRegression
    md = LogisticRegression()
    from sklearn.model_selection import train_test_split
    x_train, x_test, y_train, y_test = train_test_split(x3,y3,test_size=0.2)
    md.fit(x_train, y_train)
    # md.predict([[42,43,10]])
    md.score(x_test,y_test)
    # md.predict_proba(x_test)

    y_predicted = md.predict(x_test)
    from sklearn.metrics import confusion_matrix
    cm = confusion_matrix(y_test, y_predicted)
    sns.heatmap(cm,annot=True)
    plt.xlabel('Predicted')
    plt.ylabel('Truth')

    # mp.predict([[42,43,10]])

    from sklearn import tree
    md = tree.DecisionTreeClassifier()
    md.fit(x_train,y_train)
    md.score(x_test,y_test)
    md.predict(inputvals)
    pyscript.write('tord',md.predict(inputvals))

    </py-script>
</body>
</html>